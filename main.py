import torrent
import tracker_manager
import peer_manager

class Client(object):

    def __init__(self, debug_mode):
        self.torrent_file = torrent.Torrent()
        self.peer_list = [('5.199.233.7', 25080), ('85.94.27.159', 41061), ('87.117.62.221', 47308), ('94.233.249.179', 35890), 
                          ('104.28.154.252', 6881), ('112.9.223.239', 36776), ('185.33.229.26', 4123), ('185.177.189.11', 43263), 
                          ('186.92.7.113', 50482), ('193.0.149.210', 40024), ('220.202.152.7', 15000), ('223.196.173.48', 44130), 
                          ('223.77.125.248', 2586), ('213.196.99.174', 62625), ('213.87.195.97', 62346), ('213.24.133.85', 0), 
                          ('212.252.137.79', 12069), ('202.62.59.123', 35292), ('196.168.31.210', 54840), ('196.119.145.131', 11031), 
                          ('195.69.230.197', 49754), ('194.127.167.120', 51413), ('188.232.179.232', 57274), ('188.170.79.41', 26376), 
                          ('188.134.74.196', 53153), ('186.137.156.192', 22132), ('185.220.101.182', 41338), ('185.213.232.103', 20005), 
                          ('178.252.193.57', 30929), ('178.207.22.233', 29001), ('178.176.75.184', 60327), ('178.141.151.221', 18755), 
                          ('178.66.158.112', 29906), ('176.197.241.39', 57612), ('176.100.43.109', 56474), ('176.52.104.120', 43704), 
                          ('176.50.67.154', 49887), ('175.174.173.185', 7145), ('173.178.153.141', 42929), ('169.0.66.160', 58719), 
                          ('168.182.216.174', 29970), ('160.242.109.235', 17655), ('159.253.174.243', 19024), ('159.146.40.128', 12319), 
                          ('156.146.45.194', 8999), ('151.77.3.19', 6881), ('143.44.144.202', 41511), ('134.17.132.134', 47428), 
                          ('128.124.136.76', 60188), ('125.165.104.167', 45477), ('114.122.229.12', 15642), ('110.168.238.58', 44509), 
                          ('110.136.219.59', 46942), ('109.245.202.8', 60563), ('109.70.189.243', 16884), ('105.71.5.249', 52100), 
                          ('104.28.159.100', 34731), ('95.233.80.123', 6881), ('95.182.105.208', 46883), ('95.66.152.46', 42067), 
                          ('95.65.148.143', 43610), ('95.54.18.68', 28417), ('95.25.107.157', 28926), ('95.10.227.155', 51413), 
                          ('94.178.187.102', 59800), ('94.143.55.170', 63803), ('91.160.32.25', 7320), ('88.241.34.165', 56568), 
                          ('88.240.183.227', 6881), ('88.236.116.202', 48229), ('88.229.72.33', 54790), ('85.172.91.147', 60225), 
                          ('85.76.84.153', 47954), ('81.0.36.74', 30741), ('79.164.102.68', 43412), ('79.112.23.69', 18428), 
                          ('79.55.80.2', 6881), ('78.162.40.17', 38273), ('77.108.192.50', 6881), ('58.114.168.50', 7765), 
                          ('49.143.68.109', 30378), ('46.242.15.57', 47910), ('46.242.14.61', 24420), ('46.197.32.169', 41963), 
                          ('46.138.17.94', 60972), ('41.230.77.215', 31932), ('38.252.48.111', 27773), ('37.212.62.213', 53835), 
                          ('37.79.163.193', 39284), ('37.19.196.177', 6881), ('36.71.81.229', 64869), ('31.155.122.37', 36831), 
                          ('14.233.176.68', 3800), ('12.222.156.146', 59097), ('5.228.83.226', 25129), ('5.13.136.137', 57920), 
                          ('5.199.233.7', 25080), ('85.94.27.159', 41061), ('87.117.62.221', 47308), ('94.233.249.179', 35890), 
                          ('104.28.154.252', 6881), ('112.9.223.239', 36776), ('185.33.229.26', 4123), ('185.177.189.11', 43263), 
                          ('186.92.7.113', 50482), ('193.0.149.210', 40024), ('220.202.152.7', 15000), ('223.196.173.48', 44130), 
                          ('223.77.125.248', 2586), ('213.196.99.174', 62625), ('213.87.195.97', 62346), ('213.24.133.85', 0), 
                          ('212.252.137.79', 12069), ('202.62.59.123', 35292), ('196.168.31.210', 54840), ('196.119.145.131', 11031), 
                          ('195.69.230.197', 49754), ('194.127.167.120', 51413), ('188.232.179.232', 57274), ('188.170.79.41', 26376), 
                          ('188.134.74.196', 53153), ('186.137.156.192', 22132), ('185.220.101.182', 41338), ('185.213.232.103', 20005), 
                          ('178.252.193.57', 30929), ('178.207.22.233', 29001), ('178.176.75.184', 60327), ('178.141.151.221', 18755), 
                          ('178.66.158.112', 29906), ('176.197.241.39', 57612), ('176.100.43.109', 56474), ('176.52.104.120', 43704), 
                          ('176.50.67.154', 49887), ('175.174.173.185', 7145), ('173.178.153.141', 42929), ('169.0.66.160', 58719), 
                          ('168.182.216.174', 29970), ('160.242.109.235', 17655), ('159.253.174.243', 19024), ('159.146.40.128', 12319), 
                          ('156.146.45.194', 8999), ('151.77.3.19', 6881), ('143.44.144.202', 41511), ('134.17.132.134', 47428), 
                          ('128.124.136.76', 60188), ('125.165.104.167', 45477), ('114.122.229.12', 15642), ('110.168.238.58', 44509), 
                          ('110.136.219.59', 46942), ('109.245.202.8', 60563), ('109.70.189.243', 16884), ('105.71.5.249', 52100), 
                          ('104.28.159.100', 34731), ('95.233.80.123', 6881), ('95.182.105.208', 46883), ('95.66.152.46', 42067), 
                          ('95.65.148.143', 43610), ('95.54.18.68', 28417), ('95.25.107.157', 28926), ('95.10.227.155', 51413), 
                          ('94.178.187.102', 59800), ('94.143.55.170', 63803), ('91.160.32.25', 7320), ('88.241.34.165', 56568), 
                          ('88.240.183.227', 6881), ('88.236.116.202', 48229), ('88.229.72.33', 54790), ('85.172.91.147', 60225), 
                          ('85.76.84.153', 47954), ('81.0.36.74', 30741), ('79.164.102.68', 43412), ('79.112.23.69', 18428), 
                          ('79.55.80.2', 6881), ('78.162.40.17', 38273), ('77.108.192.50', 6881), ('58.114.168.50', 7765), 
                          ('49.143.68.109', 30378), ('46.242.15.57', 47910), ('46.242.14.61', 24420), ('46.197.32.169', 41963), 
                          ('46.138.17.94', 60972), ('41.230.77.215', 31932), ('38.252.48.111', 27773), ('37.212.62.213', 53835), 
                          ('37.79.163.193', 39284), ('37.19.196.177', 6881), ('36.71.81.229', 64869), ('31.155.122.37', 36831), 
                          ('14.233.176.68', 3800), ('12.222.156.146', 59097), ('5.228.83.226', 25129), ('5.13.136.137', 57920), 
                          ('5.199.233.7', 25080), ('85.94.27.159', 41061), ('87.117.62.221', 47308), ('94.233.249.179', 35890), 
                          ('104.28.154.252', 6881), ('112.9.223.239', 36776), ('185.33.229.26', 4123), ('185.177.189.11', 43263), 
                          ('186.92.7.113', 50482), ('193.0.149.210', 40024), ('220.202.152.7', 15000), ('223.196.173.48', 44130), 
                          ('223.77.125.248', 2586), ('213.196.99.174', 62625), ('213.87.195.97', 62346), ('213.24.133.85', 0), 
                          ('212.252.137.79', 12069), ('202.62.59.123', 35292), ('196.168.31.210', 54840), ('196.119.145.131', 11031), 
                          ('195.69.230.197', 49754), ('194.127.167.120', 51413), ('188.232.179.232', 57274), ('188.170.79.41', 26376), 
                          ('188.134.74.196', 53153), ('186.137.156.192', 22132), ('185.220.101.182', 41338), ('185.213.232.103', 20005), 
                          ('178.252.193.57', 30929), ('178.207.22.233', 29001), ('178.176.75.184', 60327), ('178.141.151.221', 18755), 
                          ('178.66.158.112', 29906), ('176.197.241.39', 57612), ('176.100.43.109', 56474), ('176.52.104.120', 43704), 
                          ('176.50.67.154', 49887), ('175.174.173.185', 7145), ('173.178.153.141', 42929), ('169.0.66.160', 58719), 
                          ('168.182.216.174', 29970), ('160.242.109.235', 17655), ('159.253.174.243', 19024), ('159.146.40.128', 12319), 
                          ('156.146.45.194', 8999), ('151.77.3.19', 6881), ('143.44.144.202', 41511), ('134.17.132.134', 47428),
                            ('128.124.136.76', 60188), ('125.165.104.167', 45477), ('114.122.229.12', 15642), ('110.168.238.58', 44509), 
                            ('110.136.219.59', 46942), ('109.245.202.8', 60563), ('109.70.189.243', 16884), ('105.71.5.249', 52100), 
                            ('104.28.159.100', 34731), ('95.233.80.123', 6881), ('95.182.105.208', 46883), ('95.66.152.46', 42067), 
                            ('95.65.148.143', 43610), ('95.54.18.68', 28417), ('95.25.107.157', 28926), ('95.10.227.155', 51413), 
                            ('94.178.187.102', 59800), ('94.143.55.170', 63803), ('91.160.32.25', 7320), ('88.241.34.165', 56568), 
                            ('88.240.183.227', 6881), ('88.236.116.202', 48229), ('88.229.72.33', 54790), ('85.172.91.147', 60225), 
                            ('85.76.84.153', 47954), ('81.0.36.74', 30741), ('79.164.102.68', 43412), ('79.112.23.69', 18428), 
                            ('79.55.80.2', 6881), ('78.162.40.17', 38273), ('77.108.192.50', 6881), ('58.114.168.50', 7765), 
                            ('49.143.68.109', 30378), ('46.242.15.57', 47910), ('46.242.14.61', 24420), ('46.197.32.169', 41963), 
                            ('46.138.17.94', 60972), ('41.230.77.215', 31932), ('38.252.48.111', 27773), ('37.212.62.213', 53835)]
        self.tracker_manager = tracker_manager.TrackerManager(self.torrent_file, True)
        self.peer_manager = peer_manager.PeerManager()
        self.debug_mode = debug_mode
    
    def _debug(self, msg):
        if self.debug_mode:
            print(msg)

    def start(self, torrent_path):
        self.torrent_file = self.torrent_file.load_from_path(torrent_path)
        #self.peer_list = self.tracker_manager.get_peers()
        #self._debug(self.peer_list)
        self.peer_manager.connect_peers(self.peer_list)



if __name__ == '__main__':
    test_path = ("D:\\Workspace\\torrent-client\\[LimeTorrents.lol]Age.of.Empires"
                 ".II.Definitive.Edition..v101.102.42346.0.#107882.11.DLCs.Bonuse"
                 "s..MULTi17..[FitGirl.Repack..Selective.Download.-.from.6.5.GB]."
                 "torrent")

    client = Client(True)
    client.start(test_path)